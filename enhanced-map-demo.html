<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced ORCAST Map - Multi-Layer Demo</title>
    
    <!-- Enhanced Map Styles -->
    <link rel="stylesheet" href="css/enhanced-map.css">
    
    <!-- Google Maps API -->
    <script async defer 
        src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=visualization&callback=initEnhancedMap">
    </script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f5f7fa;
        }
        
        .demo-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .demo-header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 300;
        }
        
        .demo-subtitle {
            margin: 8px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .features-list {
            background: rgba(255, 255, 255, 0.1);
            margin: 20px auto 0;
            padding: 16px;
            border-radius: 8px;
            max-width: 800px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            text-align: left;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .feature-icon {
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <!-- Demo Header -->
    <div class="demo-header">
        <h1>Enhanced ORCAST Map System</h1>
        <p class="demo-subtitle">Multiple Time-Based Probability Layers with Independent Controls</p>
        
        <div class="features-list">
            <div class="feature-item">
                <span class="feature-icon">üî¥</span>
                <span>Real-time live data with auto-refresh</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üîÆ</span>
                <span>Future forecasts (24h, 48h, 7d)</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üìà</span>
                <span>Historical data (day/week/month/year)</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üéõÔ∏è</span>
                <span>Independent controls per layer</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">‚è±Ô∏è</span>
                <span>Clear time period indicators</span>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üìä</span>
                <span>Real-time data point counts</span>
            </div>
        </div>
    </div>

    <!-- Enhanced Map Container -->
    <div id="enhanced-map-container" class="enhanced-map-container">
        <!-- Map and controls will be inserted here by JavaScript -->
    </div>

    <!-- Enhanced Map Script -->
    <script src="js/enhanced-map-component.js"></script>
    
    <script>
        let enhancedMap;
        
        // Initialize the enhanced map when Google Maps loads
        function initEnhancedMap() {
            console.log('Initializing Enhanced ORCAST Map...');
            
            // Configuration for the enhanced map
            const mapConfig = {
                center: { lat: 48.5465, lng: -123.0307 }, // San Juan Islands
                zoom: 11,
                updateInterval: 30000 // 30 seconds auto-refresh
            };
            
            // Create the enhanced map instance
            enhancedMap = new EnhancedORCASTMap('enhanced-map-container', mapConfig);
            
            console.log('Enhanced map initialized successfully!');
            
            // Demo: Show some interactive features after 3 seconds
            setTimeout(() => {
                showDemoFeatures();
            }, 3000);
        }
        
        function showDemoFeatures() {
            console.log('Demonstrating enhanced features...');
            
            // Show status updates
            setTimeout(() => {
                console.log('‚úÖ Real-time layer updated with live data');
            }, 1000);
            
            setTimeout(() => {
                console.log('üîÆ Forecast data loaded for next 24 hours');
            }, 2000);
            
            setTimeout(() => {
                console.log('üìà Historical data loaded for current week');
            }, 3000);
        }
        
        // Error handling for Google Maps API
        window.gm_authFailure = function() {
            console.error('Google Maps API authentication failed. Please check your API key.');
            document.getElementById('enhanced-map-container').innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #f8f9fa;">
                    <div style="text-align: center; padding: 40px; background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <h2 style="color: #e74c3c; margin-bottom: 16px;">üó∫Ô∏è Google Maps API Required</h2>
                        <p style="color: #666; margin-bottom: 20px;">To use the enhanced map features, please:</p>
                        <ol style="text-align: left; color: #666; margin-bottom: 20px;">
                            <li>Get a Google Maps API key from <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></li>
                            <li>Enable Maps JavaScript API and Visualization library</li>
                            <li>Replace "YOUR_GOOGLE_MAPS_API_KEY" in the script tag</li>
                        </ol>
                        <button onclick="location.reload()" style="padding: 12px 24px; background: #3498db; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            üîÑ Reload Page
                        </button>
                    </div>
                </div>
            `;
        };
        
        // Handle page visibility changes (pause/resume auto-updates)
        document.addEventListener('visibilitychange', function() {
            if (enhancedMap) {
                if (document.hidden) {
                    enhancedMap.stopAutoUpdate();
                    console.log('‚è∏Ô∏è Auto-update paused (page hidden)');
                } else {
                    enhancedMap.startAutoUpdate();
                    console.log('‚ñ∂Ô∏è Auto-update resumed (page visible)');
                }
            }
        });
        
        // Keyboard shortcuts for development
        document.addEventListener('keydown', function(e) {
            if (!enhancedMap) return;
            
            // Ctrl/Cmd + R = Refresh all layers
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                enhancedMap.refreshAllLayers();
                console.log('üîÑ All layers refreshed via keyboard shortcut');
            }
            
            // Ctrl/Cmd + 1-3 = Toggle layers
            if ((e.ctrlKey || e.metaKey) && ['1', '2', '3'].includes(e.key)) {
                e.preventDefault();
                const layers = ['realtime', 'future', 'historical'];
                const layerIndex = parseInt(e.key) - 1;
                const layerType = layers[layerIndex];
                
                // Toggle the layer
                const checkbox = document.getElementById(`${layerType}-enabled`);
                if (checkbox) {
                    checkbox.checked = !checkbox.checked;
                    checkbox.dispatchEvent(new Event('change'));
                    console.log(`üéõÔ∏è Toggled ${layerType} layer via keyboard shortcut`);
                }
            }
        });
        
        // Show keyboard shortcuts info
        console.log(`
üéÆ Enhanced Map Keyboard Shortcuts:
‚Ä¢ Ctrl/Cmd + R: Refresh all layers
‚Ä¢ Ctrl/Cmd + 1: Toggle real-time layer
‚Ä¢ Ctrl/Cmd + 2: Toggle future layer  
‚Ä¢ Ctrl/Cmd + 3: Toggle historical layer
        `);
    </script>
</body>
</html> 